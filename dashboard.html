<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dashboard Réservations · Choix de l'école</title>

    <!-- Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Data -->
    <script src="data.js"></script>
  </head>
  <body
    class="antialiased bg-neutral-50 text-neutral-900"
    style="
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI,
        Roboto, Helvetica, Arial, 'Apple Color Emoji', 'Segoe UI Emoji';
    "
  >
    <!-- Header -->
    <header class="sticky top-0 z-30 backdrop-blur supports-[backdrop-filter]:bg-white/70 bg-white/80 border-b border-neutral-200">
      <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
        <div class="flex h-16 items-center justify-between">
          <!-- Brand -->
          <div class="flex items-center gap-3">
            <button onclick="window.location.href='dashboard.html'" class="flex items-center gap-2 hover:opacity-80 transition">
              <span class="inline-flex h-9 w-9 items-center justify-center rounded-lg bg-neutral-900 text-white text-sm font-medium">
                GB
              </span>
              <div class="leading-tight">
                <div class="text-sm font-semibold tracking-tight">Grenoble INP</div>
                <div class="text-[11px] text-neutral-500 -mt-0.5">Classroom Booking</div>
              </div>
            </button>
          </div>

          <!-- Navigation -->
          <div class="hidden md:flex items-center gap-6">
            <nav class="flex items-center gap-6 text-sm">
              <a href="dashboard.html" class="text-neutral-900 font-medium hover:text-neutral-700 tracking-tight">Tableau de bord</a>
              <a href="#" class="text-neutral-500 hover:text-neutral-900 tracking-tight" onclick="alert('Sélectionnez un campus d\'abord'); return false;">Salles</a>
            </nav>

            <!-- User menu -->
            <div class="flex items-center gap-3">
              <button class="relative inline-flex h-9 w-9 items-center justify-center rounded-full hover:bg-neutral-100 transition">
                <i data-lucide="bell" class="w-4 h-4 text-neutral-600"></i>
              </button>
              <div class="flex items-center gap-2">
                <button
                  onclick="window.location.href='index.html'"
                  class="h-9 w-9 rounded-full overflow-hidden ring-1 ring-neutral-200 hover:ring-2 hover:ring-neutral-300 transition"
                  title="Se déconnecter"
                >
                  <img id="headerAvatar" class="h-full w-full object-cover" src="" alt="Avatar">
                </button>
                <div class="hidden sm:flex flex-col leading-tight">
                  <span id="headerUserName" class="text-sm font-medium text-neutral-800"></span>
                  <span class="text-xs text-neutral-500">Connecté</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Mobile menu button -->
          <button class="md:hidden inline-flex items-center justify-center h-10 w-10 rounded-full hover:bg-neutral-100">
            <i data-lucide="menu" class="w-6 h-6"></i>
          </button>
        </div>
      </div>
    </header>

    <!-- Main -->
    <main class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-10">
      <!-- Welcome + quick actions -->
      <section
        class="flex flex-col md:flex-row md:items-end md:justify-between gap-6"
      >
        <div>
          <h1 class="text-3xl md:text-4xl font-semibold tracking-tight">
            Bonjour, <span id="userName">Ange Roddy</span>
          </h1>
          <p class="text-neutral-600 mt-1 text-sm md:text-base">
            Gérez vos réservations et choisissez une école en quelques clics.
          </p>
        </div>
      
      </section>

      <!-- Stat cards -->
      <section class="mt-8">
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">
          <!-- Card: Total reservations -->
          <div class="rounded-2xl bg-white ring-1 ring-neutral-200 p-4">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-2">
                <div
                  class="h-9 w-9 rounded-lg bg-neutral-100 flex items-center justify-center"
                >
                  <i
                    data-lucide="building-2"
                    class="w-5 h-5 text-neutral-700"
                  ></i>
                </div>
                <span class="text-sm text-neutral-600"
                  >Réservations totales</span
                >
              </div>
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i
                  data-lucide="more-horizontal"
                  class="w-4 h-4 text-neutral-500"
                ></i>
              </button>
            </div>
            <div class="mt-3">
              <div class="text-2xl font-semibold tracking-tight" id="statTotalReservations">48</div>
              <div
                class="mt-1 text-xs text-emerald-600 inline-flex items-center gap-1"
              >
                <i data-lucide="trending-up" class="w-3.5 h-3.5"></i>
                <span id="statGrowthRate">+12%</span> ce mois
              </div>
            </div>
          </div>

          <!-- Card: En cours -->
          <div class="rounded-2xl bg-white ring-1 ring-neutral-200 p-4">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-2">
                <div
                  class="h-9 w-9 rounded-lg bg-neutral-100 flex items-center justify-center"
                >
                  <i data-lucide="clock" class="w-5 h-5 text-neutral-700"></i>
                </div>
                <span class="text-sm text-neutral-600">En cours</span>
              </div>
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i
                  data-lucide="more-horizontal"
                  class="w-4 h-4 text-neutral-500"
                ></i>
              </button>
            </div>
            <div class="mt-3">
              <div class="text-2xl font-semibold tracking-tight" id="statActiveReservations">4</div>
              <div class="mt-1 text-xs text-neutral-500">aujourd'hui</div>
            </div>
          </div>

          <!-- Card: Annulées -->
          <div class="rounded-2xl bg-white ring-1 ring-neutral-200 p-4">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-2">
                <div
                  class="h-9 w-9 rounded-lg bg-neutral-100 flex items-center justify-center"
                >
                  <i
                    data-lucide="x-circle"
                    class="w-5 h-5 text-neutral-700"
                  ></i>
                </div>
                <span class="text-sm text-neutral-600">Annulées</span>
              </div>
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i
                  data-lucide="more-horizontal"
                  class="w-4 h-4 text-neutral-500"
                ></i>
              </button>
            </div>
            <div class="mt-3">
              <div class="text-2xl font-semibold tracking-tight" id="statCancelledReservations">3</div>
              <div
                class="mt-1 text-xs text-rose-600 inline-flex items-center gap-1"
              >
                <i data-lucide="trending-down" class="w-3.5 h-3.5"></i>
                <span id="statCancellationRate">-5%</span> ce mois
              </div>
            </div>
          </div>

          <!-- Card: Taux d'occupation -->
          <div class="rounded-2xl bg-white ring-1 ring-neutral-200 p-4">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-2">
                <div
                  class="h-9 w-9 rounded-lg bg-neutral-100 flex items-center justify-center"
                >
                  <i
                    data-lucide="activity"
                    class="w-5 h-5 text-neutral-700"
                  ></i>
                </div>
                <span class="text-sm text-neutral-600">Taux d’occupation</span>
              </div>
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i
                  data-lucide="more-horizontal"
                  class="w-4 h-4 text-neutral-500"
                ></i>
              </button>
            </div>
            <div class="mt-3">
              <div class="text-2xl font-semibold tracking-tight"><span id="statOccupancyRate">72</span>%</div>
              <div
                class="mt-1 w-full bg-neutral-100 h-2 rounded-full overflow-hidden"
              >
                <div class="h-full bg-neutral-900" id="statOccupancyBar" style="width: 72%"></div>
              </div>
            </div>
          </div>

          <!-- Card: Heures réservées -->
          <div class="rounded-2xl bg-white ring-1 ring-neutral-200 p-4">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-2">
                <div
                  class="h-9 w-9 rounded-lg bg-neutral-100 flex items-center justify-center"
                >
                  <i
                    data-lucide="hourglass"
                    class="w-5 h-5 text-neutral-700"
                  ></i>
                </div>
                <span class="text-sm text-neutral-600">Heures réservées</span>
              </div>
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i
                  data-lucide="more-horizontal"
                  class="w-4 h-4 text-neutral-500"
                ></i>
              </button>
            </div>
            <div class="mt-3">
              <div class="text-2xl font-semibold tracking-tight"><span id="statHoursReserved">134</span>h</div>
              <div class="mt-1 text-xs text-neutral-500">30 derniers jours</div>
            </div>
          </div>
        </div>

        <!-- Activity chart -->
        <div class="mt-6 grid grid-cols-1 lg:grid-cols-3 gap-4">
          <div
            class="lg:col-span-3 rounded-2xl bg-white ring-1 ring-neutral-200 p-5"
          >
            <div class="flex items-center justify-between">
              <div>
                <h2 class="text-lg font-semibold tracking-tight">
                  Activité des réservations
                </h2>
                <p class="text-sm text-neutral-600 mt-0.5">30 derniers jours</p>
              </div>
              <div class="flex items-center gap-2">
                <button
                  class="text-xs px-3 py-1.5 rounded-full ring-1 ring-neutral-200 hover:bg-neutral-50"
                >
                  Semaine
                </button>
                <button
                  class="text-xs px-3 py-1.5 rounded-full bg-neutral-900 text-white"
                >
                  Mois
                </button>
              </div>
            </div>
            <!-- Important wrapper around canvas to avoid growth bug -->
            <div class="mt-4">
              <div class="relative h-48">
                <canvas id="activityChart" class="absolute inset-0"></canvas>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Mes Réservations -->
      <section class="mt-12">
        <div class="flex items-center justify-between mb-6">
          <div>
            <h2 class="text-2xl font-semibold tracking-tight">Mes Réservations</h2>
            <p class="text-sm text-neutral-600 mt-1">Vos réservations à venir</p>
          </div>
          <a href="#" class="text-sm font-medium text-neutral-900 hover:text-neutral-700">
            Voir tout
          </a>
        </div>

        <div id="reservationsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          <!-- Les réservations seront chargées ici dynamiquement -->
        </div>

        <!-- Empty state -->
        <div id="emptyReservations" class="hidden text-center py-12 rounded-xl border border-neutral-200 bg-white">
          <div class="inline-flex h-16 w-16 items-center justify-center rounded-full bg-neutral-100 mb-4">
            <i data-lucide="calendar-x" class="w-8 h-8 text-neutral-500"></i>
          </div>
          <h3 class="text-lg font-semibold tracking-tight mb-2">Aucune réservation</h3>
          <p class="text-sm text-neutral-600 mb-4">Vous n'avez pas encore de réservation à venir</p>
          <a href="#campus-section" class="inline-flex items-center gap-2 rounded-lg bg-neutral-900 px-4 py-2 text-sm font-medium text-white hover:bg-black transition">
            <i data-lucide="plus" class="w-4 h-4"></i>
            Créer une réservation
          </a>
        </div>
      </section>

      <!-- Campus selection heading -->
      <section id="campus-section" class="mt-12 text-center">
        <p class="text-sm text-neutral-600">
          Vous souhaitez effectuer une autre réservation ?
        </p>
        <h3 class="mt-1 text-2xl md:text-3xl font-semibold tracking-tight">
          Choix de l'école
        </h3>
        <p class="mt-1 text-sm text-neutral-600">
          Sélectionnez l'école où vous souhaitez réserver la salle
        </p>
      </section>

      <!-- Filters -->
      <section
        class="mt-6 flex flex-col md:flex-row gap-3 md:items-center md:justify-between"
      >
        <div class="flex-1">
          <label class="sr-only" for="search">Rechercher</label>
          <div class="relative">
            <i
              data-lucide="search"
              class="w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-neutral-500"
            ></i>
            <input
              id="search"
              type="text"
              placeholder="Rechercher une école..."
              class="w-full pl-9 pr-3 py-2.5 rounded-xl bg-white ring-1 ring-neutral-200 text-sm placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-neutral-900"
            />
          </div>
        </div>
        <div class="flex items-center gap-2 overflow-x-auto">
          <button
            data-filter="all"
            class="filter-btn rounded-full px-3.5 py-2 text-xs font-medium bg-neutral-900 text-white"
          >
            Toutes
          </button>
          <button
            data-filter="Grenoble"
            class="filter-btn rounded-full px-3.5 py-2 text-xs font-medium ring-1 ring-neutral-200 bg-white"
          >
            Grenoble
          </button>
          <button
            data-filter="Valence"
            class="filter-btn rounded-full px-3.5 py-2 text-xs font-medium ring-1 ring-neutral-200 bg-white"
          >
            Valence
          </button>
        </div>
      </section>

      <!-- Campus grid -->
      <section
        id="campusGrid"
        class="mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"
      >
        <!-- Ense³ -->
        <article
          data-city="Grenoble"
          class="group rounded-2xl ring-1 ring-neutral-200 bg-white overflow-hidden hover:shadow-sm transition"
        >
          <div class="p-4 flex items-center justify-between">
            <div class="flex items-center gap-2">
              <div
                class="h-8 w-8 rounded-full bg-neutral-100 flex items-center justify-center"
              >
                <i data-lucide="building" class="w-4 h-4 text-neutral-700"></i>
              </div>
              <span class="text-sm font-medium">Grenoble INP - Ense³</span>
            </div>
            <div class="flex items-center gap-1">
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i data-lucide="heart" class="w-4 h-4 text-neutral-500"></i>
              </button>
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i
                  data-lucide="more-horizontal"
                  class="w-4 h-4 text-neutral-500"
                ></i>
              </button>
            </div>
          </div>
          <div class="px-4">
            <div
              class="aspect-[16/9] w-full rounded-xl overflow-hidden bg-neutral-100"
            >
              <img
                class="h-full w-full object-cover group-hover:scale-[1.02] transition"
                src="https://images.unsplash.com/photo-1497436072909-60f360e1d4b1?q=80&w=1600&auto=format&fit=crop"
                alt="Grenoble INP - Ense³"
              />
            </div>
          </div>
          <div class="p-4">
            <div class="flex items-center gap-2 text-neutral-600 text-sm">
              <i data-lucide="map-pin" class="w-4 h-4"></i>
              <span>Grenoble, Auvergne-Rhône-Alpes</span>
            </div>
            <p class="mt-2 text-sm text-neutral-600 line-clamp-2">
              École de l'énergie, l'eau et l'environnement. Labs spécialisés, équipements modernes.
            </p>
            <div class="flex items-center gap-2 mt-3">
              <span class="text-[11px] px-2 py-1 rounded-full bg-neutral-100"
                >Capacité 30</span
              >
              <span class="text-[11px] px-2 py-1 rounded-full bg-neutral-100"
                >Wi‑Fi 1 Gbps</span
              >
              <span class="text-[11px] px-2 py-1 rounded-full bg-neutral-100"
                >Labs</span
              >
            </div>
          </div>
          <div class="px-4 pb-4">
            <div
              class="flex items-center justify-between rounded-xl bg-neutral-50 p-2"
            >
              <button
                class="inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm ring-1 ring-neutral-200 bg-white hover:bg-neutral-50"
              >
                <i data-lucide="info" class="w-4 h-4"></i>
                Détails
              </button>
              <button
                data-campus="Grenoble INP - Ense³"
                class="reserve-btn inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-white bg-neutral-900 hover:bg-neutral-800"
              >
                <i data-lucide="calendar-check-2" class="w-4 h-4"></i>
                Réserver
              </button>
            </div>
          </div>
        </article>

        <!-- Ensimag -->
        <article
          data-city="Grenoble"
          class="group rounded-2xl ring-1 ring-neutral-200 bg-white overflow-hidden hover:shadow-sm transition"
        >
          <div class="p-4 flex items-center justify-between">
            <div class="flex items-center gap-2">
              <div
                class="h-8 w-8 rounded-full bg-neutral-100 flex items-center justify-center"
              >
                <i data-lucide="building" class="w-4 h-4 text-neutral-700"></i>
              </div>
              <span class="text-sm font-medium">Grenoble INP - Ensimag</span>
            </div>
            <div class="flex items-center gap-1">
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i data-lucide="heart" class="w-4 h-4 text-neutral-500"></i>
              </button>
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i
                  data-lucide="more-horizontal"
                  class="w-4 h-4 text-neutral-500"
                ></i>
              </button>
            </div>
          </div>
          <div class="px-4">
            <div
              class="aspect-[16/9] w-full rounded-xl overflow-hidden bg-neutral-100"
            >
              <img
                class="h-full w-full object-cover group-hover:scale-[1.02] transition"
                src="https://images.unsplash.com/photo-1517694712202-14dd9538aa97?q=80&w=1600&auto=format&fit=crop"
                alt="Grenoble INP - Ensimag"
              />
            </div>
          </div>
          <div class="p-4">
            <div class="flex items-center gap-2 text-neutral-600 text-sm">
              <i data-lucide="map-pin" class="w-4 h-4"></i>
              <span>Grenoble, Auvergne‑Rhône‑Alpes</span>
            </div>
            <p class="mt-2 text-sm text-neutral-600 line-clamp-2">
              École d'informatique et mathématiques appliquées. Salles informatiques équipées.
            </p>
            <div class="flex items-center gap-2 mt-3">
              <span class="text-[11px] px-2 py-1 rounded-full bg-neutral-100"
                >Capacité 35</span
              >
              <span class="text-[11px] px-2 py-1 rounded-full bg-neutral-100"
                >Salles info</span
              >
            </div>
          </div>
          <div class="px-4 pb-4">
            <div
              class="flex items-center justify-between rounded-xl bg-neutral-50 p-2"
            >
              <button
                class="inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm ring-1 ring-neutral-200 bg-white hover:bg-neutral-50"
              >
                <i data-lucide="info" class="w-4 h-4"></i>
                Détails
              </button>
              <button
                data-campus="Grenoble INP - Ensimag"
                class="reserve-btn inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-white bg-neutral-900 hover:bg-neutral-800"
              >
                <i data-lucide="calendar-check-2" class="w-4 h-4"></i>
                Réserver
              </button>
            </div>
          </div>
        </article>

        <!-- Marseille -->
        <article
          data-city="Valence"
          class="group rounded-2xl ring-1 ring-neutral-200 bg-white overflow-hidden hover:shadow-sm transition"
        >
          <div class="p-4 flex items-center justify-between">
            <div class="flex items-center gap-2">
              <div
                class="h-8 w-8 rounded-full bg-neutral-100 flex items-center justify-center"
              >
                <i data-lucide="building" class="w-4 h-4 text-neutral-700"></i>
              </div>
              <span class="text-sm font-medium">Grenoble INP - Esisar</span>
            </div>
            <div class="flex items-center gap-1">
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i data-lucide="heart" class="w-4 h-4 text-neutral-500"></i>
              </button>
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i
                  data-lucide="more-horizontal"
                  class="w-4 h-4 text-neutral-500"
                ></i>
              </button>
            </div>
          </div>
          <div class="px-4">
            <div
              class="aspect-[16/9] w-full rounded-xl overflow-hidden bg-neutral-100"
            >
              <img
                class="h-full w-full object-cover group-hover:scale-[1.02] transition"
                src="https://images.unsplash.com/photo-1460353581641-37baddab0fa2?q=80&w=1600&auto=format&fit=crop"
                alt="Grenoble INP - Esisar"
              />
            </div>
          </div>
          <div class="p-4">
            <div class="flex items-center gap-2 text-neutral-600 text-sm">
              <i data-lucide="map-pin" class="w-4 h-4"></i>
              <span>Marseille, Provence‑Alpes‑Côte d’Azur</span>
            </div>
            <p class="mt-2 text-sm text-neutral-600 line-clamp-2">
              École en systèmes avancés et réseaux. Équipements électroniques et réseaux.
            </p>
            <div class="flex items-center gap-2 mt-3">
              <span class="text-[11px] px-2 py-1 rounded-full bg-neutral-100"
                >Capacité 16</span
              >
              <span class="text-[11px] px-2 py-1 rounded-full bg-neutral-100"
                >Terrasse</span
              >
            </div>
          </div>
          <div class="px-4 pb-4">
            <div
              class="flex items-center justify-between rounded-xl bg-neutral-50 p-2"
            >
              <button
                class="inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm ring-1 ring-neutral-200 bg-white hover:bg-neutral-50"
              >
                <i data-lucide="info" class="w-4 h-4"></i>
                Détails
              </button>
              <button
                data-campus="Grenoble INP - Esisar"
                class="reserve-btn inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-white bg-neutral-900 hover:bg-neutral-800"
              >
                <i data-lucide="calendar-check-2" class="w-4 h-4"></i>
                Réserver
              </button>
            </div>
          </div>
        </article>

        <!-- Lille -->
        <article
          data-city="Grenoble"
          class="group rounded-2xl ring-1 ring-neutral-200 bg-white overflow-hidden hover:shadow-sm transition"
        >
          <div class="p-4 flex items-center justify-between">
            <div class="flex items-center gap-2">
              <div
                class="h-8 w-8 rounded-full bg-neutral-100 flex items-center justify-center"
              >
                <i data-lucide="building" class="w-4 h-4 text-neutral-700"></i>
              </div>
              <span class="text-sm font-medium">Grenoble INP - Génie industriel</span>
            </div>
            <div class="flex items-center gap-1">
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i data-lucide="heart" class="w-4 h-4 text-neutral-500"></i>
              </button>
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i
                  data-lucide="more-horizontal"
                  class="w-4 h-4 text-neutral-500"
                ></i>
              </button>
            </div>
          </div>
          <div class="px-4">
            <div
              class="aspect-[16/9] w-full rounded-xl overflow-hidden bg-neutral-100"
            >
              <img
                class="h-full w-full object-cover group-hover:scale-[1.02] transition"
                src="https://images.unsplash.com/photo-1464146072230-91cabc968266?q=80&w=1600&auto=format&fit=crop"
                alt="Grenoble INP - Génie industriel"
              />
            </div>
          </div>
          <div class="p-4">
            <div class="flex items-center gap-2 text-neutral-600 text-sm">
              <i data-lucide="map-pin" class="w-4 h-4"></i>
              <span>Grenoble, Auvergne‑Rhône‑Alpes</span>
            </div>
            <p class="mt-2 text-sm text-neutral-600 line-clamp-2">
              Formation en management industriel. Espaces de travail en équipe et innovation.
            </p>
            <div class="flex items-center gap-2 mt-3">
              <span class="text-[11px] px-2 py-1 rounded-full bg-neutral-100"
                >Capacité 20</span
              >
              <span class="text-[11px] px-2 py-1 rounded-full bg-neutral-100"
                >Visio 4K</span
              >
            </div>
          </div>
          <div class="px-4 pb-4">
            <div
              class="flex items-center justify-between rounded-xl bg-neutral-50 p-2"
            >
              <button
                class="inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm ring-1 ring-neutral-200 bg-white hover:bg-neutral-50"
              >
                <i data-lucide="info" class="w-4 h-4"></i>
                Détails
              </button>
              <button
                data-campus="Grenoble INP - Génie industriel"
                class="reserve-btn inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-white bg-neutral-900 hover:bg-neutral-800"
              >
                <i data-lucide="calendar-check-2" class="w-4 h-4"></i>
                Réserver
              </button>
            </div>
          </div>
        </article>

        <!-- Nantes -->
        <article
          data-city="Grenoble"
          class="group rounded-2xl ring-1 ring-neutral-200 bg-white overflow-hidden hover:shadow-sm transition"
        >
          <div class="p-4 flex items-center justify-between">
            <div class="flex items-center gap-2">
              <div
                class="h-8 w-8 rounded-full bg-neutral-100 flex items-center justify-center"
              >
                <i data-lucide="building" class="w-4 h-4 text-neutral-700"></i>
              </div>
              <span class="text-sm font-medium">Grenoble INP - Pagora</span>
            </div>
            <div class="flex items-center gap-1">
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i data-lucide="heart" class="w-4 h-4 text-neutral-500"></i>
              </button>
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i
                  data-lucide="more-horizontal"
                  class="w-4 h-4 text-neutral-500"
                ></i>
              </button>
            </div>
          </div>
          <div class="px-4">
            <div
              class="aspect-[16/9] w-full rounded-xl overflow-hidden bg-neutral-100"
            >
              <img
                class="h-full w-full object-cover group-hover:scale-[1.02] transition"
                src="https://images.unsplash.com/photo-1503387762-592deb58ef4e?q=80&w=1600&auto=format&fit=crop"
                alt="Grenoble INP - Pagora"
              />
            </div>
          </div>
          <div class="p-4">
            <div class="flex items-center gap-2 text-neutral-600 text-sm">
              <i data-lucide="map-pin" class="w-4 h-4"></i>
              <span>Grenoble, Auvergne‑Rhône‑Alpes</span>
            </div>
            <p class="mt-2 text-sm text-neutral-600 line-clamp-2">
              École du papier, communication imprimée et biomatériaux. Labs impression et matériaux.
            </p>
            <div class="flex items-center gap-2 mt-3">
              <span class="text-[11px] px-2 py-1 rounded-full bg-neutral-100"
                >Capacité 30</span
              >
              <span class="text-[11px] px-2 py-1 rounded-full bg-neutral-100"
                >Accès PMR</span
              >
            </div>
          </div>
          <div class="px-4 pb-4">
            <div
              class="flex items-center justify-between rounded-xl bg-neutral-50 p-2"
            >
              <button
                class="inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm ring-1 ring-neutral-200 bg-white hover:bg-neutral-50"
              >
                <i data-lucide="info" class="w-4 h-4"></i>
                Détails
              </button>
              <button
                data-campus="Grenoble INP - Pagora"
                class="reserve-btn inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-white bg-neutral-900 hover:bg-neutral-800"
              >
                <i data-lucide="calendar-check-2" class="w-4 h-4"></i>
                Réserver
              </button>
            </div>
          </div>
        </article>

        <!-- Toulouse -->
        <article
          data-city="Grenoble"
          class="group rounded-2xl ring-1 ring-neutral-200 bg-white overflow-hidden hover:shadow-sm transition"
        >
          <div class="p-4 flex items-center justify-between">
            <div class="flex items-center gap-2">
              <div
                class="h-8 w-8 rounded-full bg-neutral-100 flex items-center justify-center"
              >
                <i data-lucide="building" class="w-4 h-4 text-neutral-700"></i>
              </div>
              <span class="text-sm font-medium">Grenoble INP - Phelma</span>
            </div>
            <div class="flex items-center gap-1">
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i data-lucide="heart" class="w-4 h-4 text-neutral-500"></i>
              </button>
              <button
                class="h-8 w-8 rounded-full hover:bg-neutral-100 flex items-center justify-center"
              >
                <i
                  data-lucide="more-horizontal"
                  class="w-4 h-4 text-neutral-500"
                ></i>
              </button>
            </div>
          </div>
          <div class="px-4">
            <div
              class="aspect-[16/9] w-full rounded-xl overflow-hidden bg-neutral-100"
            >
              <img
                class="h-full w-full object-cover group-hover:scale-[1.02] transition"
                src="https://images.unsplash.com/photo-1495462911434-be47104d70fa?q=80&w=1600&auto=format&fit=crop"
                alt="Grenoble INP - Phelma"
              />
            </div>
          </div>
          <div class="p-4">
            <div class="flex items-center gap-2 text-neutral-600 text-sm">
              <i data-lucide="map-pin" class="w-4 h-4"></i>
              <span>Grenoble, Auvergne‑Rhône‑Alpes</span>
            </div>
            <p class="mt-2 text-sm text-neutral-600 line-clamp-2">
              École de physique, électronique et matériaux. Labs recherche et équipements avancés.
            </p>
            <div class="flex items-center gap-2 mt-3">
              <span class="text-[11px] px-2 py-1 rounded-full bg-neutral-100"
                >Capacité 22</span
              >
              <span class="text-[11px] px-2 py-1 rounded-full bg-neutral-100"
                >Parking</span
              >
            </div>
          </div>
          <div class="px-4 pb-4">
            <div
              class="flex items-center justify-between rounded-xl bg-neutral-50 p-2"
            >
              <button
                class="inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm ring-1 ring-neutral-200 bg-white hover:bg-neutral-50"
              >
                <i data-lucide="info" class="w-4 h-4"></i>
                Détails
              </button>
              <button
                data-campus="Grenoble INP - Phelma"
                class="reserve-btn inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-white bg-neutral-900 hover:bg-neutral-800"
              >
                <i data-lucide="calendar-check-2" class="w-4 h-4"></i>
                Réserver
              </button>
            </div>
          </div>
        </article>
      </section>
    </main>

    <!-- Modal -->
    <div
      id="modal"
      class="fixed inset-0 hidden items-center justify-center z-50"
    >
      <div class="absolute inset-0 bg-black/40"></div>
      <div
        class="relative bg-white rounded-2xl shadow-xl w-[92%] max-w-md ring-1 ring-neutral-200"
      >
        <div class="p-5">
          <div class="flex items-center justify-between">
            <h4 class="text-lg font-semibold tracking-tight">
              Confirmer la réservation
            </h4>
            <button
              id="modalClose"
              class="h-9 w-9 rounded-full hover:bg-neutral-100 flex items-center justify-center"
            >
              <i data-lucide="x" class="w-5 h-5"></i>
            </button>
          </div>
          <p id="modalCampus" class="text-sm text-neutral-600 mt-1">
            École sélectionnée
          </p>

          <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3">
            <div class="rounded-xl ring-1 ring-neutral-200 p-3">
              <div class="text-xs text-neutral-500">Date</div>
              <div class="flex items-center gap-2 mt-1 text-sm">
                <i data-lucide="calendar" class="w-4 h-4 text-neutral-600"></i>
                <input
                  type="date"
                  class="w-full bg-transparent focus:outline-none"
                />
              </div>
            </div>
            <div class="rounded-xl ring-1 ring-neutral-200 p-3">
              <div class="text-xs text-neutral-500">Créneau</div>
              <div class="flex items-center gap-2 mt-1 text-sm">
                <i data-lucide="clock" class="w-4 h-4 text-neutral-600"></i>
                <input
                  type="time"
                  value="09:00"
                  class="w-full bg-transparent focus:outline-none"
                />
              </div>
            </div>
          </div>

          <div class="mt-4 rounded-xl ring-1 ring-neutral-200 p-3">
            <div class="text-xs text-neutral-500">Intitulé</div>
            <input
              type="text"
              placeholder="Nom de l’événement (facultatif)"
              class="mt-1 w-full bg-transparent focus:outline-none text-sm"
            />
          </div>

          <div class="mt-5 flex items-center justify-between">
            <button
              id="modalCancel"
              class="inline-flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm ring-1 ring-neutral-200 bg-white hover:bg-neutral-50"
            >
              Annuler
            </button>
            <button
              class="inline-flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm text-white bg-neutral-900 hover:bg-neutral-800"
            >
              <i data-lucide="check" class="w-4 h-4"></i>
              Continuer
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 hidden">
      <div
        class="rounded-full bg-neutral-900 text-white px-4 py-2 text-sm shadow-lg flex items-center gap-2"
      >
        <i data-lucide="bell" class="w-4 h-4"></i>
        Filtre mis à jour
      </div>
    </div>

    <!-- JS -->
    <script>
      // Charger les données de l'utilisateur et les statistiques
      document.addEventListener('DOMContentLoaded', () => {
        // Charger le nom de l'utilisateur
        const user = getCurrentUser();
        document.getElementById('userName').textContent = user.firstName;

        // Charger les données du header
        document.getElementById('headerUserName').textContent = user.firstName;
        document.getElementById('headerAvatar').src = user.avatar;

        // Charger les statistiques
        const stats = getStatistics();
        document.getElementById('statTotalReservations').textContent = stats.totalReservations;
        document.getElementById('statActiveReservations').textContent = stats.activeReservations;
        document.getElementById('statCancelledReservations').textContent = stats.cancelledReservations;
        document.getElementById('statOccupancyRate').textContent = stats.occupancyRate;
        document.getElementById('statOccupancyBar').style.width = stats.occupancyRate + '%';
        document.getElementById('statHoursReserved').textContent = stats.hoursReserved;
        document.getElementById('statGrowthRate').textContent = '+' + stats.growthRate + '%';
        document.getElementById('statCancellationRate').textContent = stats.cancellationRate + '%';

        // Charger les réservations de l'utilisateur
        loadUserReservations();
      });

      // Fonction pour charger les réservations
      function loadUserReservations() {
        const user = getCurrentUser();
        const userReservations = getReservations(user.id);

        // Filtrer les réservations à venir (pas annulées, pas terminées)
        const today = new Date();
        const upcomingReservations = userReservations.filter(r => {
          const resDate = new Date(r.date);
          return r.status === 'confirmée' && resDate >= today;
        });

        const reservationsList = document.getElementById('reservationsList');
        const emptyState = document.getElementById('emptyReservations');

        if (upcomingReservations.length === 0) {
          reservationsList.classList.add('hidden');
          emptyState.classList.remove('hidden');
        } else {
          reservationsList.classList.remove('hidden');
          emptyState.classList.add('hidden');

          // Afficher les réservations
          reservationsList.innerHTML = upcomingReservations.map(reservation => {
            const room = getRoomById(reservation.roomId);
            const campus = getCampusById(reservation.campusId);

            // Formater la date
            const resDate = new Date(reservation.date);
            const dateFormatted = resDate.toLocaleDateString('fr-FR', {
              weekday: 'short',
              day: 'numeric',
              month: 'short'
            });

            return `
              <div class="rounded-xl border border-neutral-200 bg-white p-5 hover:border-neutral-300 transition">
                <div class="flex items-start justify-between mb-3">
                  <div class="flex-1">
                    <h3 class="font-semibold tracking-tight text-neutral-900">${room ? room.name : 'Salle'}</h3>
                    <p class="text-xs text-neutral-500 mt-0.5">${campus ? campus.name : 'Campus'}</p>
                  </div>
                  <span class="inline-flex items-center gap-1 rounded-full bg-emerald-100 px-2.5 py-1 text-xs font-medium text-emerald-700">
                    <i data-lucide="check-circle" class="w-3 h-3"></i>
                    Confirmée
                  </span>
                </div>

                <div class="space-y-2 mb-4">
                  <div class="flex items-center gap-2 text-sm text-neutral-700">
                    <i data-lucide="calendar" class="w-4 h-4 text-neutral-500"></i>
                    <span>${dateFormatted}</span>
                  </div>
                  <div class="flex items-center gap-2 text-sm text-neutral-700">
                    <i data-lucide="clock" class="w-4 h-4 text-neutral-500"></i>
                    <span>${reservation.startTime} - ${reservation.endTime}</span>
                  </div>
                  <div class="flex items-center gap-2 text-sm text-neutral-700">
                    <i data-lucide="users" class="w-4 h-4 text-neutral-500"></i>
                    <span>${reservation.participants} participants</span>
                  </div>
                </div>

                <div class="flex gap-2">
                  <button
                    onclick="viewReservationDetails(${reservation.id})"
                    class="flex-1 rounded-lg bg-neutral-900 px-3 py-2 text-xs font-medium text-white hover:bg-black transition"
                  >
                    Détails
                  </button>
                  <button
                    onclick="cancelReservation(${reservation.id})"
                    class="rounded-lg border border-neutral-300 px-3 py-2 text-xs font-medium text-neutral-700 hover:bg-neutral-50 transition"
                  >
                    Annuler
                  </button>
                </div>
              </div>
            `;
          }).join('');

          // Re-créer les icônes Lucide
          if (window.lucide) window.lucide.createIcons();
        }
      }

      // Fonction pour voir les détails d'une réservation
      function viewReservationDetails(reservationId) {
        const reservation = getReservationById(reservationId);
        if (!reservation) return;

        const room = getRoomById(reservation.roomId);
        const campus = getCampusById(reservation.campusId);

        alert(`Réservation #${reservationId}\n\nCampus: ${campus ? campus.name : 'N/A'}\nSalle: ${room ? room.name : 'N/A'}\nDate: ${reservation.date}\nHoraire: ${reservation.startTime} - ${reservation.endTime}\nParticipants: ${reservation.participants}\nObjet: ${reservation.purpose}\nStatut: ${reservation.status}`);
      }

      // Fonction pour annuler une réservation
      function cancelReservation(reservationId) {
        if (confirm('Êtes-vous sûr de vouloir annuler cette réservation ?')) {
          const success = window.cancelReservation(reservationId);
          if (success) {
            alert('Réservation annulée avec succès.');
            loadUserReservations(); // Recharger la liste
          } else {
            alert('Erreur lors de l\'annulation.');
          }
        }
      }

      // Icons
      lucide.createIcons();

      // Activity Chart
      const ctx = document.getElementById("activityChart");
      if (ctx) {
        const gradient = ctx
          .getContext("2d")
          .createLinearGradient(0, 0, 0, 180);
        gradient.addColorStop(0, "rgba(17,17,17,0.35)");
        gradient.addColorStop(1, "rgba(17,17,17,0.03)");

        // Utiliser les vraies données depuis data.js
        const chartData = getActivityData();

        new Chart(ctx, {
          type: "line",
          data: {
            labels: chartData.map(d => `${d.day}`),
            datasets: [
              {
                label: "Réservations",
                data: chartData.map(d => d.reservations),
                borderColor: "#111111",
                backgroundColor: gradient,
                fill: true,
                tension: 0.35,
                borderWidth: 2,
                pointRadius: 0,
                pointHoverRadius: 2,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false },
              tooltip: {
                mode: "index",
                intersect: false,
                displayColors: false,
                callbacks: { label: (ctx) => ` ${ctx.parsed.y} réservations` },
              },
            },
            scales: {
              x: {
                grid: { display: false },
                ticks: { color: "#737373", font: { size: 11 } },
              },
              y: {
                grid: { color: "#efefef" },
                ticks: { color: "#737373", font: { size: 11 } },
              },
            },
          },
        });
      }

      // Filters
      const filterButtons = document.querySelectorAll(".filter-btn");
      const cards = document.querySelectorAll("#campusGrid article");
      const searchInput = document.getElementById("search");
      let activeCity = "all";

      function applyFilters() {
        const q = (searchInput.value || "").toLowerCase().trim();
        cards.forEach((card) => {
          const city = card.getAttribute("data-city");
          const text = card.textContent.toLowerCase();
          const matchCity = activeCity === "all" || city === activeCity;
          const matchQuery = q === "" || text.includes(q);
          card.style.display = matchCity && matchQuery ? "" : "none";
        });
      }

      filterButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          filterButtons.forEach((b) => {
            b.classList.remove("bg-neutral-900", "text-white");
            b.classList.add("bg-white");
          });
          btn.classList.add("bg-neutral-900", "text-white");
          btn.classList.remove("bg-white");

          activeCity = btn.getAttribute("data-filter");
          applyFilters();
          showToast("Filtre: " + (activeCity === "all" ? "Tous" : activeCity));
        });
      });

      searchInput.addEventListener("input", () => {
        applyFilters();
      });

      // Toast
      let toastTimer;
      function showToast(message) {
        const toast = document.getElementById("toast");
        toast.querySelector("div").lastChild.textContent = " " + message;
        toast.classList.remove("hidden", "opacity-0");
        clearTimeout(toastTimer);
        toastTimer = setTimeout(() => toast.classList.add("hidden"), 1600);
      }

      // Modal
      const modal = document.getElementById("modal");
      const modalCampus = document.getElementById("modalCampus");
      const closeModal = () => modal.classList.add("hidden");
      document
        .getElementById("modalClose")
        .addEventListener("click", closeModal);
      document
        .getElementById("modalCancel")
        .addEventListener("click", closeModal);
      modal.addEventListener("click", (e) => {
        if (e.target === modal) closeModal();
      });

      document.querySelectorAll(".reserve-btn").forEach((btn) => {
        btn.addEventListener("click", () => {
          const campusName = btn.getAttribute("data-campus");

          // Trouver le campus par son nom
          const campus = campuses.find(c => c.name === campusName);

          if (campus) {
            // Stocker l'ID et le nom du campus
            localStorage.setItem('selectedCampusId', campus.id);
            localStorage.setItem('selectedCampusName', campus.name);

            // Rediriger vers la page de sélection des salles
            window.location.href = 'select.html';
          }
        });
      });
    </script>
  </body>
</html>
